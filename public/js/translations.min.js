/*
 * @link      https://github.com/rarog/TranslationManagerForAndroidApps for the canonical source repository
 * @copyright Copyright (c) 2017 Andrej Sinicyn
 * @license   https://www.gnu.org/licenses/gpl-3.0.html GNU General Public License version 3 or later
 */
function enableBootstrapTooltips(){$(function(){$('[data-toggle="tooltip"]').tooltip({container:"body"})})}function hideSelectionHint(a){var b=$("#selectionHint");if(a){b.addClass("hidden")}else{b.removeClass("hidden")}}function hideSpinner(a){var b=$("#spinner");if(a){b.addClass("hidden")}else{b.removeClass("hidden")}}function hideTranslationRow(a){var c=$("#translationRow");if(a){c.addClass("hidden");$("translationTableBody").empty()}else{c.removeClass("hidden");var b=$("#translations").DataTable()}}function setSelectionNeededState(){hideSelectionHint(false);hideSpinner(true);hideTranslationRow(true)}function showModalError(){$("#modalError").modal()}function hideModalSpinner(a){var b=$("#modalContainer .modal-spinner");if(a){b.css("display","none")}else{b.css("display","block")}}function hideBootstrapTooltips(){$(".tooltip").tooltip("hide")}var curResources=resources;$("#showAll").on("change",function(a){var b=$("#app");b.selectpicker("deselectAll");$("option",b).remove();curApps=(a.target.checked)?appsAll:apps;curResources=(a.target.checked)?resourcesAll:resources;$.each(curApps,function(c,d){b.append('<option value="'+c+'">'+d+"</option>")})});$("#app").on("changed.bs.select",function(e,d,f,a){setSelectionNeededState();var c=$("#resource");$("option",c).remove();if(f){var b=$(this).val();if(b in curResources){$.each(curResources[b],function(g,h){c.append('<option value="'+g+'">'+h+"</option>")})}}c.selectpicker("refresh")});$("#resource").on("changed.bs.select",function(c,b,e,a){if(e){hideSelectionHint(true);hideSpinner(false);hideTranslationRow(true);var f=$("#app").val();var d=$(this).val();$.ajax({url:translationsPath+"/app/"+f+"/resource/"+d,dataType:"json",method:"GET"}).done(function(h){var g=$("#translations").DataTable();g.clear().rows.add(h).draw();hideSelectionHint(true);hideSpinner(true);hideTranslationRow(false);enableBootstrapTooltips()}).fail(function(g,i,h){setSelectionNeededState()})}else{setSelectionNeededState()}});$("#translations").on("click",".translationDetails",function(b){var d=$("#app").val();var c=$("#resource").val();var a=$(b.target).data("entryid");$.ajax({url:detailsPath+"/app/"+d+"/resource/"+c+"/entry/"+a,dataType:"json",method:"GET"}).done(function(e){if($.type(e)=="object"&&e.modal){$("#modalContainer").html(e.modal);$("#modalDetails").on("shown.bs.modal",function(f){initSuggestions();$("#modalContainer #suggestions").DataTable().rows.add(suggestionData).draw();enableBootstrapTooltips()}).on("hidden.bs.modal",function(f){$("#modalContainer #suggestions").DataTable().destroy()}).modal()}else{showModalError()}}).fail(function(e,g,f){showModalError()})});$("#modalContainer").on("click",".suggestionVote",function(d){var c=$(this);if(c.hasClass("disabled")){return}var f=$("#app").val();var e=$("#resource").val();var a=c.data("suggestionid");var b=c.data("vote");hideBootstrapTooltips();hideModalSpinner(false);$.ajax({url:suggestionvotePath+"/app/"+f+"/resource/"+e+"/entry/"+suggestionEntryId+"/suggestion/"+a+"/vote/"+b,dataType:"json",method:"GET"}).done(function(g){if($.type(g)=="object"&&g.suggestion){$("#modalContainer #suggestions").DataTable().row("#suggestion-"+a).data(g.suggestion).draw();enableBootstrapTooltips()}else{showModalError()}hideModalSpinner(true)}).fail(function(g,i,h){showModalError();hideModalSpinner(true)})});$("#modalContainer").on("click",".suggestionEdit",function(d){var b=$(this);if(b.hasClass("disabled")){return}var e=0;var a=b.data("suggestion");if($.type(a)==="object"&&$.type(a.id)==="number"){e=a.id}else{a=null}hideBootstrapTooltips();var c=$("#modalContainer #suggestionAddEdit");if(c.hasClass("in")){c.one("hidden.bs.collapse",function(){showSuggestionAddEdit(e,a)}).collapse("hide")}else{showSuggestionAddEdit(e,a)}});function showSuggestionAddEdit(f,b){var c=$("#modalContainer #suggestionAddEdit");var a=null;if(suggestionType=="String"){var d="";if(($.type(b)==="object")&&($.type(b.value)==="string")){d=b.value}var e=$("#modalContainer #suggestionAddEditText");e.val(d);a=e}c.collapse("show");$("#modalDetails").animate({scrollTop:c.offset().top});if(a!==null){a.focus()}};